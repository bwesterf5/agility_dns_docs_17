

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5. F5 DNS 201 &mdash; agility_dns_docs_17 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="agility_dns_docs_17 0.1 documentation" href="index.html"/>
        <link rel="next" title="6. RPZ" href="rpz/index.html"/>
        <link rel="prev" title="4. Cache" href="cache/index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> agility_dns_docs_17
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="lab_access/index.html">1. Lab Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab_topology/index.html">2. Lab Topology</a></li>
<li class="toctree-l1"><a class="reference internal" href="gslb/index.html">3. GSLB</a></li>
<li class="toctree-l1"><a class="reference internal" href="cache/index.html">4. Cache</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. F5 DNS 201</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#exercise-1-1-authoritative-ns-slave-from-off-box-bind">5.1. EXERCISE 1.1 – AUTHORITATIVE NS: SLAVE FROM OFF-BOX BIND</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#task-1-configuring-dns-logging">5.1.1. TASK 1 – Configuring DNS Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-2-create-a-new-dns-profile">5.1.2. TASK 2 – Create a new DNS Profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-3-create-dns-listeners">5.1.3. TASK 3 – Create DNS Listeners</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-4-create-a-nameserver-for-hidden-master">5.1.4. TASK 4 – Create a Nameserver for Hidden Master</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-5-create-a-zone-to-transfer-from-hidden-master">5.1.5. TASK 5 – Create a zone to transfer from Hidden Master</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-6-enable-dnssec-for-the-zone">5.1.6. TASK 6 – Enable DNSSEC for the zone</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercise-1-2-authoritative-ns-slave-from-on-box-bind">5.2. EXERCISE 1.2 – AUTHORITATIVE NS: SLAVE FROM ON-BOX BIND</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-1-create-a-new-dns-profile">5.3. TASK 1 – Create a new DNS Profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="#task-2-edit-dns-listeners">5.4. TASK 2 – Edit DNS Listeners</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#task-3-create-a-student1-com-zone-using-zonerunner">5.4.1. TASK 3 – Create a Student1.com zone using ZoneRunner</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-4-create-a-nameserver-for-on-box-bind">5.4.2. TASK 4 – Create a Nameserver for on-box BIND</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-5-create-a-dns-express-zone-to-transfer-from-zonerunner">5.4.3. TASK 5 – Create a DNS Express zone to transfer from ZoneRunner</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercise-1-3-slaving-off-of-dns-express">5.5. EXERCISE 1.3 – SLAVING OFF OF DNS EXPRESS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">5.5.1. TASK 1 – Create a new DNS Profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">5.5.2. TASK 2 – Edit DNS Listeners</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-3-create-nameservers-for-zone-transfer-clients">5.5.3. TASK 3 – Create Nameservers for Zone Transfer Clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-4-edit-student2-zones-on-bigip2-to-allow-zone-transfer">5.5.4. TASK 4 – Edit Student2 Zones on BIGIP2 to allow Zone transfer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-5-add-student2-com-zone-to-dns-express-on-bigip1">5.5.5. TASK 5 – Add Student2.com zone to DNS Express on BIGIP1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercise-2-1-transparent-caching">5.6. EXERCISE 2.1 – TRANSPARENT CACHING</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#task-1-create-a-dns-cache">5.6.1. TASK 1 – Create a DNS Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">5.6.2. TASK 2 – Create a new DNS Profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-3-create-a-dns-monitor">5.6.3. TASK 3 – Create a DNS Monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-4-create-a-resolver-pool">5.6.4. TASK 4 – Create a Resolver Pool</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-5-create-a-new-external-dns-listener">5.6.5. TASK 5 – Create a new External DNS Listener</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercise-2-2-resolver-cache">5.7. EXERCISE 2.2 – RESOLVER CACHE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#task-1-create-a-new-dns-cache">5.7.1. TASK 1 – Create a new DNS Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">5.7.2. TASK 2 – Create a new DNS Profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-3-edit-dns-listener">5.7.3. TASK 3 – Edit DNS Listener</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercise-2-3-validating-resolver">5.8. EXERCISE 2.3 – VALIDATING RESOLVER</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">5.8.1. TASK 1 – Create a new DNS Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">5.8.2. TASK 2 – Create a new DNS Profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">5.8.3. TASK 3 – Edit DNS Listener</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercise-2-4-forwarders">5.9. EXERCISE 2.4 – FORWARDERS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#task-1-add-forwarder-to-existing-cache">5.9.1. TASK 1 – Add Forwarder to Existing Cache</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#learn-more">5.10. Learn More</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rpz/index.html">6. RPZ</a></li>
<li class="toctree-l1"><a class="reference internal" href="ipi/index.html">7. IPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="dnsx/index.html">8. Slave</a></li>
<li class="toctree-l1"><a class="reference internal" href="irules/index.html">9. iRules</a></li>
<li class="toctree-l1"><a class="reference internal" href="big-iq/index.html">10. BIG-IQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">agility_dns_docs_17</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>5. F5 DNS 201</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/dns201_agility2017.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p>Agility 2017 Hands-on Lab Guide</p>
<p>DNS Services Beyond GSLB with BIG-IP DNS (201)</p>
<p>Written for: TMOS<sup>®</sup> v13.0.0</p>
<p>Presented by: DNS 2017 F5 Agility Team</p>
<div class="section" id="f5-dns-201">
<h1>5. F5 DNS 201<a class="headerlink" href="#f5-dns-201" title="Permalink to this headline">¶</a></h1>
<div class="section" id="exercise-1-1-authoritative-ns-slave-from-off-box-bind">
<h2>5.1. EXERCISE 1.1 – AUTHORITATIVE NS: SLAVE FROM OFF-BOX BIND<a class="headerlink" href="#exercise-1-1-authoritative-ns-slave-from-off-box-bind" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Objective:</strong> In this use-case, you will configure GTM as the
authoritative slave using an off-box BIND server as the hidden
master. This is a very common architecture to serve either external
or internal zones with large scale RPS via DNS Express. You will
configure the following common components:</li>
<li>DNS Profile and Listeners</li>
<li>DNS Express</li>
<li>DNS Query Logging</li>
<li>DNS Statistics</li>
<li>DNSSEC signing</li>
<li>Estimated completion time: 25 minutes</li>
</ul>
<div class="section" id="task-1-configuring-dns-logging">
<h3>5.1.1. TASK 1 – Configuring DNS Logging<a class="headerlink" href="#task-1-configuring-dns-logging" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>You are going to configure DNS query and response logging. To do
this, you must tell GTM where to send logs to (a log publisher) and
what specifically to log (DNS logging profile).</li>
<li>For lab purposes, we are going to use local-syslog as our logging
destination. <strong>Note that remote high-speed logging is the
recommendation for production environments.</strong></li>
<li>Log in to <strong>BIGIP1</strong> by clicking on the browser shortcut on your
desktop and using u: <strong>admin</strong> p: <strong>admin</strong></li>
<li>In the GUI, navigate to: <strong>System &gt; Logs &gt; Configuration &gt; Log
Publishers: Create</strong></li>
<li>Create a new DNS Log Publisher as shown in the table below. Keep the
defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">dns-local-syslog</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Destinations</strong></td>
<td>Move local-syslog to Selected column</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Click <strong>Finished</strong> to create.</li>
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Profiles &gt; Other &gt; DNS
Logging: Create</strong></li>
<li>Create a new DNS logging profile as shown in the table below. Keep
the defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="47%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">dns-logging</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Log Publisher</strong></td>
<td>Select dns-local-syslog</td>
</tr>
<tr class="row-odd"><td><strong>Log Responses</strong></td>
<td>Enabled</td>
</tr>
<tr class="row-even"><td><strong>Include Query ID</strong></td>
<td>Enabled</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Click <strong>Finished</strong> to create.</li>
<li>Your new dns-logging profile should now have all options enabled.</li>
</ul>
</div>
<div class="section" id="task-2-create-a-new-dns-profile">
<h3>5.1.2. TASK 2 – Create a new DNS Profile<a class="headerlink" href="#task-2-create-a-new-dns-profile" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>A DNS profile tells the DNS Listener how to process DNS traffic.
We’re going to make some tweaks for our use-case and lab environment.</li>
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Profiles &gt; DNS: Create</strong></li>
<li>Create a new DNS profile as shown in the table below. Keep the
defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">AuthNS-offbox-BIND</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Unhandled Query Action</strong></td>
<td>Drop</td>
</tr>
<tr class="row-odd"><td><strong>Use BIND Server on Big-IP</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-even"><td><strong>Logging</strong></td>
<td>Enabled</td>
</tr>
<tr class="row-odd"><td><strong>Logging Profile</strong></td>
<td>dns-logging</td>
</tr>
<tr class="row-even"><td><strong>AVR Statistics Sampling Rate</strong></td>
<td>Enabled; 1/1 queries sampled</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Click <strong>Finished</strong> to create.</li>
<li>For lab purposes, we are going to use sample all DNS queries with
AVR. <strong>Note that production sampling rates would be a much lower rate
as this would severely impact performance.</strong></li>
</ul>
</div>
<div class="section" id="task-3-create-dns-listeners">
<h3>5.1.3. TASK 3 – Create DNS Listeners<a class="headerlink" href="#task-3-create-dns-listeners" title="Permalink to this headline">¶</a></h3>
<p>We are going to create both an internal and external Listener. The
external Listener will be our target IP address when querying GTM. The
internal Listener will be used merely to accept NOTIFY messages from our
off-box BIND server.</p>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Listeners &gt; Listener
List: Create</strong></li>
<li>Create two <strong>internal</strong> Listeners as shown in the tables below. Keep
the defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">internal-listener-UDP</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Destination</strong></td>
<td>Host: 10.128.20.240</td>
</tr>
<tr class="row-odd"><td><strong>VLAN Traffic</strong></td>
<td>Enabled on..</td>
</tr>
<tr class="row-even"><td><strong>VLANs and Tunnels</strong></td>
<td>Internal</td>
</tr>
<tr class="row-odd"><td><strong>DNS Profile</strong></td>
<td>AuthNS-offbox-BIND</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">internal-listener-TCP</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Destination</strong></td>
<td>Host: 10.128.20.240</td>
</tr>
<tr class="row-odd"><td><strong>VLAN Traffic</strong></td>
<td>Enabled on..</td>
</tr>
<tr class="row-even"><td><strong>VLANs and Tunnels</strong></td>
<td>Internal</td>
</tr>
<tr class="row-odd"><td><strong>Protocol</strong></td>
<td>TCP</td>
</tr>
<tr class="row-even"><td><strong>DNS Profile</strong></td>
<td>AuthNS-offbox-BIND</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>For each Listener, click <strong>Finished</strong> to create.</li>
<li>Create two <strong>external</strong> Listeners as shown in the tables below. Keep
the defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">external-listener-UDP</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Destination</strong></td>
<td>Host: 10.128.10.53</td>
</tr>
<tr class="row-odd"><td><strong>VLAN Traffic</strong></td>
<td>Enabled on..</td>
</tr>
<tr class="row-even"><td><strong>VLANs and Tunnels</strong></td>
<td>External</td>
</tr>
<tr class="row-odd"><td><strong>DNS Profile</strong></td>
<td>AuthNS-offbox-BIND</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">external-listener-TCP</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Destination</strong></td>
<td>Host: 10.128.10.53</td>
</tr>
<tr class="row-odd"><td><strong>VLAN Traffic</strong></td>
<td>Enabled on..</td>
</tr>
<tr class="row-even"><td><strong>VLANs and Tunnels</strong></td>
<td>External</td>
</tr>
<tr class="row-odd"><td><strong>Protocol</strong></td>
<td>TCP</td>
</tr>
<tr class="row-even"><td><strong>DNS Profile</strong></td>
<td>AuthNS-offbox-BIND</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>For each Listener, click <strong>Finished</strong> to create.</li>
<li>You should now have two UDP-based DNS Listeners and two TCP-based
Listeners configured.</li>
</ul>
</div>
<div class="section" id="task-4-create-a-nameserver-for-hidden-master">
<h3>5.1.4. TASK 4 – Create a Nameserver for Hidden Master<a class="headerlink" href="#task-4-create-a-nameserver-for-hidden-master" title="Permalink to this headline">¶</a></h3>
<p>We next need to tell GTM about our Hidden Master that DNS Express will
slave from.</p>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Nameservers &gt; Nameserver
List: Create</strong></li>
<li>Create offbox-BIND as a Nameserver as shown in the table below. Keep
the defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="47%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">Offbox-BIND</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Address</strong></td>
<td>10.128.20.250</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Click <strong>Finished</strong> to create.</li>
</ul>
</div>
<div class="section" id="task-5-create-a-zone-to-transfer-from-hidden-master">
<h3>5.1.5. TASK 5 – Create a zone to transfer from Hidden Master<a class="headerlink" href="#task-5-create-a-zone-to-transfer-from-hidden-master" title="Permalink to this headline">¶</a></h3>
<p>We will now configure the specific zone for GTM to obtain from the
Hidden Master. Note that the BIND server already has some key
configuration elements to consider:</p>
<blockquote>
<div><ul class="simple">
<li>“Allow-transfer” (for lab purposes, any sourceIP is allowed)</li>
<li>“Also-notify” for your internal Listener IP address.</li>
<li>TSIG is disabled.</li>
</ul>
</div></blockquote>
<ul>
<li><p class="first">Before we configure the zone, we are going to enable some debug
logging so that you can see what happens underneath the covers. SSH
to your F5 BIGIP1. You should have a BIGIP1 putty icon on your
desktop. Use username: <strong>root</strong> password: <strong>default</strong> and issue the
following TMSH command once logged in.</p>
<blockquote>
<div><p><strong>tmsh modify sys db log.zxfrd.level value &#8220;debug&#8221;</strong></p>
<p>Now, view the log file real-time by issuing this command at the SSH
prompt:</p>
<p><strong>tail –f /var/log/ltm</strong></p>
<p><strong>Note: You can make the putty window larger if needed</strong></p>
<p>Keep your ssh session open while performing the rest of the steps.
You can break out of the tail process with &lt;Ctrl-C&gt;.</p>
</div></blockquote>
</li>
<li><p class="first">In the GUI, navigate to: <strong>DNS &gt; Zones &gt; Zones &gt; Zone List: Create</strong></p>
</li>
<li><p class="first">Create the <strong>“dnsx.com”</strong> zone as shown in the figure below and then
click <strong>Finished.</strong></p>
</li>
</ul>
<p><a class="reference internal" href="_images/image4.png"><img alt="image1" src="_images/image4.png" style="width: 3.93000in; height: 3.05000in;" /></a></p>
<ul class="simple">
<li>You should see log messages in your SSH console indicating a
successful transfer from the hidden master. You can also view the
state of the transfer by clicking back on the newly created zone and
observing the “Availability” as shown in the figure below.</li>
</ul>
<p><a class="reference internal" href="_images/image5.png"><img alt="image2" src="_images/image5.png" style="width: 2.66667in; height: 1.41319in;" /></a></p>
<ul class="simple">
<li>Issue the following command from SSH console to see specifics of the
status and statistics related to the zone.</li>
</ul>
<p><strong>tmsh show ltm dns zone dnsx.com |more</strong></p>
<ul class="simple">
<li>The dnsx.com zone is configured with a 60 second refresh interval –
meaning that DNS Express will proactively check the Master Nameserver
every 60 seconds for zone updates. This very low interval is merely
for lab purposes so you can view what happens in the logs. The log
messages look like this:</li>
</ul>
<p>Jun 5 07:48:01 bigip1 debug zxfrd[6429]: 01531025:7: Serials equal
(2006081429); transfer for zone dnsx.com complete.</p>
<p>Jun 5 07:48:01 bigip1 debug zxfrd[6429]: 01531008:7: Resetting transfer
state for zone dnsx.com.</p>
<p>Jun 5 07:48:01 bigip1 debug zxfrd[6429]: 01531023:7: Scheduling zone
transfer in 60s for dnsx.com from 10.128.20.250.</p>
<ul class="simple">
<li>Now, issue the following command in the SSH console to view what is
in DNS Express.</li>
</ul>
<p><strong>dnsxdump |more</strong></p>
<ul class="simple">
<li>Open the command prompt from your windows desktop. Issue a DNS query
against your external listener for a record in the dnsx.com zone and
verify that it succeeds. For example:</li>
</ul>
<p><strong>&gt;dig &#64;10.128.10.53 +short www1.dnsx.com</strong></p>
<p>10.10.20.55</p>
<ul class="simple">
<li>Issue several more queries of different types to generate some
interesting statistics. Here are some examples:</li>
<li>dig &#64;10.128.10.53 +short www1.dnsx.com</li>
<li>dig &#64;10.128.10.53 +short www2.dnsx.com</li>
<li>dig &#64;10.128.10.53 +short www3.dnsx.com</li>
<li>dig &#64;10.128.10.53 +short bigip1.dnsx.com</li>
<li>dig &#64;10.128.10.53 +short bigip2.dnsx.com</li>
<li>dig &#64;10.128.10.53 +short MX dnsx.com</li>
<li>dig &#64;10.128.10.53 +short NS dnsx.com</li>
<li>Now is a good time to check query logging. Look at /var/log/ltm (i.e.
“tail /var/log/ltm”) to ensure that you’re properly logging queries
and responses. It should look something like this:</li>
</ul>
<p>Jun 4 20:33:24 localhost info tmm[14258]: 2015-06-04 20:33:23
bigip1.f5agility.com qid 46533 from 10.128.10.240#51377: view none:
<strong>query: www3.dnsx.com IN A +E (10.128.10.53%0)</strong></p>
<p>Jun 4 20:33:24 localhost info tmm[14258]: 2015-06-04 20:33:23
bigip1.f5agility.com qid 46533 to 10.128.10.240#51377: [NOERROR
qr,aa,rd] <strong>response: www3.dnsx.com. 38400 IN A 10.10.20.57;</strong></p>
<ul class="simple">
<li>In the GUI, navigate to <strong>Statistics &gt; Analytics &gt; DNS</strong>. Notice that
you can view statics by different data points, over different periods of
time, and drill down into different aspects. Spend a few moments looking
at the various options.</li>
</ul>
<p><em>*Note: This may take up to 5 minutes to populate. If no data exists,
come back after the next task.</em></p>
</div>
<div class="section" id="task-6-enable-dnssec-for-the-zone">
<h3>5.1.6. TASK 6 – Enable DNSSEC for the zone<a class="headerlink" href="#task-6-enable-dnssec-for-the-zone" title="Permalink to this headline">¶</a></h3>
<p>We will now sign the dnsx.com zone. In this example, we are configuring
GTM to sign the zone on the fly rather than signing the actual static
zone information (which can be done starting in v11.5 but is outside the
scope of this lab).</p>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Keys &gt; DNSSEC Key List:
Create</strong></li>
<li>Create two keys as defined in the tables below. Keep the defaults if
not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="52%" />
<col width="48%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">dnsx.com_zsk</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Type</strong></td>
<td>Zone Signing Key</td>
</tr>
<tr class="row-odd"><td><strong>Key Management</strong></td>
<td>Manual</td>
</tr>
<tr class="row-even"><td><strong>Certificate</strong></td>
<td>default.crt</td>
</tr>
<tr class="row-odd"><td><strong>Private Key</strong></td>
<td>default.key</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="54%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">dnsx.com_ksk</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Type</strong></td>
<td>Key Signing Key</td>
</tr>
<tr class="row-odd"><td><strong>Key Management</strong></td>
<td>Manual</td>
</tr>
<tr class="row-even"><td><strong>Certificate</strong></td>
<td>default.crt</td>
</tr>
<tr class="row-odd"><td><strong>Private Key</strong></td>
<td>default.key</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Click <strong>Finished</strong> to create each key.</li>
<li>In the GUI, navigate to: <strong>DNS &gt; Zones &gt; DNSSEC Zones &gt; DNSSEC Zone
List: Create</strong></li>
<li>Configure the dnsx.com zone for DNSSEC using the previously created
keys as shown below.</li>
</ul>
<p><a class="reference internal" href="_images/image6.png"><img alt="image3" src="_images/image6.png" style="width: 3.23729in; height: 2.35556in;" /></a></p>
<ul class="simple">
<li>Test that the zone is successfully signed by issuing a DNSSEC query
to the external listener. For example:</li>
</ul>
<p><strong>dig &#64;10.128.10.53 +dnssec www1.dnsx.com</strong></p>
<p>You should see RRSIG records indicating that the zone is signed. You
will also</p>
<p>note signing in the query logs (/var/log/ltm)</p>
<ul class="simple">
<li>Finally, view some other DNS statistics related to queries, DNSSEC,
zone transfers, notifies, etc.</li>
<li>In the GUI, navigate to: <strong>DNS &gt; Zone &gt; Zones &gt; Zone List.</strong></li>
<li><dl class="first docutils">
<dt>Click on the “dnsx.com” zone and then select “Statistics” from the</dt>
<dd>top menu bar.</dd>
</dl>
</li>
<li>Select the “View” Details as shown in the diagram below:</li>
</ul>
<p><a class="reference internal" href="_images/image7.png"><img alt="image4" src="_images/image7.png" style="width: 3.96000in; height: 1.71000in;" /></a></p>
<ul class="simple">
<li><dl class="first docutils">
<dt>View the types of statistics available for the zone such as serial</dt>
<dd>number, number of records, etc.</dd>
</dl>
</li>
<li>In the GUI, navigate to: <strong>Statistics &gt; Module Statistics &gt; DNS &gt; Zones</strong>.</li>
<li>Set “Statistics Type” to <strong>“DNSSEC Zones”.</strong></li>
<li><dl class="first docutils">
<dt>View details as performed above. Note the various DNSSEC statistics</dt>
<dd>available.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>If the graphs from task 5 weren’t available earlier, revisit</dt>
<dd><strong>Statistics &gt; Analytics &gt; DNS</strong> now and explore.</dd>
</dl>
</li>
</ul>
</div>
</div>
<div class="section" id="exercise-1-2-authoritative-ns-slave-from-on-box-bind">
<h2>5.2. EXERCISE 1.2 – AUTHORITATIVE NS: SLAVE FROM ON-BOX BIND<a class="headerlink" href="#exercise-1-2-authoritative-ns-slave-from-on-box-bind" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>In this use-case, you will configure GTM as an authoritative slave
using on-box BIND managed by ZoneRunner.</li>
<li>Estimated completion time: 15 minutes</li>
</ul>
</div>
<div class="section" id="task-1-create-a-new-dns-profile">
<h2>5.3. TASK 1 – Create a new DNS Profile<a class="headerlink" href="#task-1-create-a-new-dns-profile" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Profiles &gt; DNS: Create.</strong>
Create a new DNS profile as shown in the table below. Keep the
defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">AuthNS-onbox-BIND</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Unhandled Query Action</strong></td>
<td>Drop</td>
</tr>
<tr class="row-odd"><td><strong>Use BIND Server on Big-IP</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-even"><td><strong>Logging</strong></td>
<td>Enabled</td>
</tr>
<tr class="row-odd"><td><strong>Logging Profile</strong></td>
<td>dns-logging</td>
</tr>
<tr class="row-even"><td><strong>AVR Statistics Sampling Rate</strong></td>
<td>Enabled; 1/1 queries sampled</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Click <strong>Finished</strong> to create.</li>
<li>For lab purposes, we are going to sample all DNS queries with AVR.
<em>Note that production sampling rates would be a much lower rate.</em></li>
</ul>
</div>
<div class="section" id="task-2-edit-dns-listeners">
<h2>5.4. TASK 2 – Edit DNS Listeners<a class="headerlink" href="#task-2-edit-dns-listeners" title="Permalink to this headline">¶</a></h2>
<p>We need to edit the external-listeners to use the new DNS profile
created above.</p>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Listeners &gt; Listener List</strong></li>
<li><dl class="first docutils">
<dt>Edit the external-listener-UDP to use the AuthNS-onbox-BIND DNS</dt>
<dd>profile.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Edit the external-listener-TCP to use the AuthNS-onbox-BIND DNS</dt>
<dd>profile.</dd>
</dl>
</li>
<li>Click <strong>Update</strong> after change DNS profile to finish edition.</li>
</ul>
<div class="section" id="task-3-create-a-student1-com-zone-using-zonerunner">
<h3>5.4.1. TASK 3 – Create a Student1.com zone using ZoneRunner<a class="headerlink" href="#task-3-create-a-student1-com-zone-using-zonerunner" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Zones: ZoneRunner &gt; Zone List: Create</strong></li>
<li>Add a student1.com zone with the information as shown in the
following screenshot. Note the “also-notify” message needs to be
added to send a NOTIFY message to an internal GTM IP address for
processing. Likewise BIND needs to allow the transfer from the
loopback address. The diagram below shows the basic operation.</li>
</ul>
<p><a class="reference internal" href="_images/image8.png"><img alt="image5" src="_images/image8.png" style="width: 3.13333in; height: 1.40000in;" /></a></p>
<p><a class="reference internal" href="_images/image9.png"><img alt="image6" src="_images/image9.png" style="width: 5.31042in; height: 6.32847in;" /></a></p>
</div>
<div class="section" id="task-4-create-a-nameserver-for-on-box-bind">
<h3>5.4.2. TASK 4 – Create a Nameserver for on-box BIND<a class="headerlink" href="#task-4-create-a-nameserver-for-on-box-bind" title="Permalink to this headline">¶</a></h3>
<p>Next, we need to tell DNS Express that on-box BIND is available to use
as a source for zone transfers.</p>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Nameservers &gt; Nameserver List: Create</strong></li>
<li>Create a loopback as a Nameserver as shown in the table below. Keep
the defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="52%" />
<col width="48%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">ZoneRunner</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Address</strong></td>
<td>127.0.0.1</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Click <strong>Finished</strong> to create.</li>
</ul>
</div>
<div class="section" id="task-5-create-a-dns-express-zone-to-transfer-from-zonerunner">
<h3>5.4.3. TASK 5 – Create a DNS Express zone to transfer from ZoneRunner<a class="headerlink" href="#task-5-create-a-dns-express-zone-to-transfer-from-zonerunner" title="Permalink to this headline">¶</a></h3>
<p>We will now configure the specific zone for GTM to obtain from
ZoneRunner. Note that on-box BIND already has some key configuration
elements to consider:</p>
<blockquote>
<div><ul class="simple">
<li>“Allow-transfer” from the localhost.</li>
<li>“Also-notify” for DNS Express internal Listener IP address.</li>
<li>TSIG is disabled.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Zones &gt; Zones &gt; Zone List: Create</strong></li>
<li>Create the “student1.com” zone as shown in the figure below and then
click <strong>Finished.</strong></li>
</ul>
<p><a class="reference internal" href="_images/image10.png"><img alt="image7" src="_images/image10.png" style="width: 4.03000in; height: 3.21000in;" /></a></p>
<ul>
<li><p class="first">Perform the same validation steps as the previous lab for validating
the successful transfer of student1.com to DNS Express</p>
</li>
<li><p class="first">View the details of the zone in the GUI</p>
</li>
<li><p class="first">Issue a tmsh show ltm dns zone student1.com |more command from SSH
console</p>
</li>
<li><p class="first">Issue the dnsxdump |more command from SSH console</p>
</li>
<li><p class="first">Verify logs in /var/log/ltm</p>
</li>
<li><p class="first">From a command prompt on your jumpbox, issue a query to the external
listener for a record in the zone</p>
<blockquote>
<div><p>dig &#64;10.128.10.53 SOA student1.com</p>
</div></blockquote>
</li>
<li><p class="first">Add a new record to the Student1.com zone in ZoneRunner</p>
</li>
<li><p class="first">In the GUI, navigate to: <strong>DNS &gt; Zones: ZoneRunner &gt; Resource Record List.</strong></p>
</li>
<li><p class="first">Select View Name -&gt; external</p>
</li>
<li><p class="first">Select Zone Name -&gt; student1.com.</p>
</li>
<li><p class="first">Click <strong>Create</strong></p>
</li>
<li><p class="first">Enter a new A record similar to the figure below for your zone and
click <strong>Finished</strong>.</p>
</li>
</ul>
<p><a class="reference internal" href="_images/image11.png"><img alt="image8" src="_images/image11.png" style="width: 3.95000in; height: 2.51000in;" /></a></p>
<ul class="simple">
<li>Validate the DNS Express was updated by performing a dnsxdump and/or
query for your new record to the Listener.</li>
<li>Add another record using the steps above for <strong>www2.student1.com</strong>
with IP address of <strong>10.41.3.2</strong> but before doing this, make sure to
have a putty session open to your BIG-IP1 and tail the logs using
‘tail –f /var/log/ltm’ to view the changes. By making a change to the
zone on the Hidden Master (in this case ZoneRunner), you will see a
proactive update to DNS Express via a NOTIFY. Watch the /var/log/ltm
file to see the update occur. The logs should look something like
this:</li>
</ul>
<p>Jun 5 08:21:26 bigip1 notice zxfrd[6429]: 0153101c:5: Handling NOTIFY
for zone student1.com.</p>
<p>Jun 5 08:21:26 bigip1 debug zxfrd[6429]: 01531008:7: Resetting transfer
state for zone student1.com.</p>
<p>Jun 5 08:21:26 bigip1 debug zxfrd[6429]: 01531023:7: Scheduling zone
transfer in 5s for student1.com from 127.0.0.1.</p>
<p>Jun 5 08:21:26 bigip1 debug zxfrd[6429]: 01531027:7: Notify response to
::1 succeeded (81:na).</p>
<p>Jun 5 08:21:31 bigip1 notice zxfrd[6429]: 0153101f:5: IXFR Transfer of
zone student1.com from 127.0.0.1 succeeded.</p>
<p> Issue a dnsxdump | more command for the SSH console or a query to the
listener to validate the zone file has updated.</p>
</div>
</div>
<div class="section" id="exercise-1-3-slaving-off-of-dns-express">
<h2>5.5. EXERCISE 1.3 – SLAVING OFF OF DNS EXPRESS<a class="headerlink" href="#exercise-1-3-slaving-off-of-dns-express" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>In this use-case, we will obtain a zone transfer from another F5’s
DNS Express. This is a common deployment in a hybrid on-premise and
cloud-based DNS solution. Our purpose here is to focus on DNS Express
serving zone transfer clients. Note that zones can be signed during a
transfer – but this is outside the scope of this lab.</li>
<li>Estimated completion time: 10 minutes</li>
</ul>
<div class="section" id="id1">
<h3>5.5.1. TASK 1 – Create a new DNS Profile<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Profiles &gt; DNS: Create.</strong>
Create a new DNS profile as shown in the table below. Keep the
defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">AuthNS-hybrid</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Unhandled Query Action</strong></td>
<td>Drop</td>
</tr>
<tr class="row-odd"><td><strong>Use BIND Server on Big-IP</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-even"><td><strong>Zone Transfer</strong></td>
<td>Enabled</td>
</tr>
<tr class="row-odd"><td><strong>Logging</strong></td>
<td>Enabled</td>
</tr>
<tr class="row-even"><td><strong>Logging Profile</strong></td>
<td>dns-logging</td>
</tr>
<tr class="row-odd"><td><strong>AVR Statistics Sampling Rate</strong></td>
<td>Enabled; 1/1 queries sampled</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>For lab purposes, we are going to use sample all DNS queries with
AVR. <em>Note that production sampling rates would be a much lower
rate.</em></li>
</ul>
</div>
<div class="section" id="id2">
<h3>5.5.2. TASK 2 – Edit DNS Listeners<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Listeners &gt; Listener
List</strong></li>
<li>Edit the internal-listener-TCP to use the AuthNS-hybrid DNS profile.</li>
<li>Click <strong>Update</strong> to finish.</li>
</ul>
</div>
<div class="section" id="task-3-create-nameservers-for-zone-transfer-clients">
<h3>5.5.3. TASK 3 – Create Nameservers for Zone Transfer Clients<a class="headerlink" href="#task-3-create-nameservers-for-zone-transfer-clients" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Your lab environment has a second pre-configured BIG-IP (BIGIP2) that
we will use as the on-prem DNS Express Master.</li>
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Nameservers &gt; Nameserver List: Create</strong></li>
<li>Create BIGIP2’s F5 as a Nameserver as shown in the table below. You
will use the Internal SelfIP/Listener. Keep the defaults if not noted
in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="45%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">On-prem-master</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Address</strong></td>
<td>10.128.20.230</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="task-4-edit-student2-zones-on-bigip2-to-allow-zone-transfer">
<h3>5.5.4. TASK 4 – Edit Student2 Zones on BIGIP2 to allow Zone transfer<a class="headerlink" href="#task-4-edit-student2-zones-on-bigip2-to-allow-zone-transfer" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Log in to BIGIP2 (shortcut located on desktop) using a new browser
window with the following credentials:</p>
</li>
<li><p class="first"><a class="reference external" href="https://10.128.1.235">https://10.128.1.235</a></p>
</li>
<li><p class="first">User: <strong>admin</strong> Pass: <strong>admin</strong></p>
</li>
<li><p class="first">In the GUI, navigate to: <strong>DNS &gt; Zones &gt; Zones &gt; Zone List</strong></p>
</li>
<li><p class="first">Edit the existing student2.com zone.</p>
</li>
<li><p class="first">Under Zone Transfer Clients, move <strong>BIGIP1</strong> (pre-defined to save
time) to Active and <strong>Update</strong>.</p>
<p><em>**Note: The internal TCP listener on BIGIP2 is using the
AuthNS-hybrid profile which is setup exactly like the profile with
the same name on BIGIP1. ‘Zone Transfer = Enabled’ must be set in the
profile on the source for this to work correctly.</em></p>
</li>
<li><p class="first">Return to your BIGIP1 browser session</p>
</li>
</ul>
</div>
<div class="section" id="task-5-add-student2-com-zone-to-dns-express-on-bigip1">
<h3>5.5.5. TASK 5 – Add Student2.com zone to DNS Express on BIGIP1<a class="headerlink" href="#task-5-add-student2-com-zone-to-dns-express-on-bigip1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI on BIGIP1, navigate to: <strong>DNS &gt; Zones &gt; Zones &gt; Zone List: Create</strong></li>
<li>Create the “student2.com” zone as shown in the figure below and then
click Finished. Your GTM is acting as a zone transfer client in this
case (looking to receive a transfer of the on-prem student2.com local
zone). This example shows BIGIP1 adding the student2.com zone to pull
from DNS Express on BIGIP2.</li>
</ul>
<p><a class="reference internal" href="_images/image12.png"><img alt="image9" src="_images/image12.png" style="width: 3.95000in; height: 2.97000in;" /></a></p>
<ul>
<li><p class="first">Perform the same validation steps as the previous lab for validating
the successful transfer of student2.com zone</p>
</li>
<li><p class="first">View the details of the zone in the GUI</p>
</li>
<li><p class="first">Issue a dnsxdump |more command from SSH console</p>
</li>
<li><p class="first">Verify logs in /var/log/ltm</p>
</li>
<li><p class="first">Issue a query to the external listener for a record in the zone</p>
<p>dig &#64;10.128.10.53 SOA student2.com</p>
</li>
<li><p class="first">Open putty sessions to both BIGIP1 and BIGIP2 and tail the logs using
‘tail –f /var/log/ltm’. This will allow us to see the process of
adding a new record on the Master on-prem server (BIGIP2) and then it
being replicated first to DNS Express on its own box, followed by an
update to the cloud GTM (BIGIP1) in this scenario.</p>
</li>
<li><p class="first">Add a new record to the student2.com zone in ZoneRunner on <strong>BIGIP2</strong>
(10.128.1.235)</p>
</li>
<li><p class="first">In the GUI, navigate to: <strong>DNS &gt; Zones: ZoneRunner &gt; Resource Record List</strong></p>
</li>
<li><p class="first">Select View Name -&gt; external</p>
</li>
<li><p class="first">Select Zone Name -&gt; student2.com.</p>
</li>
<li><p class="first">Click <strong>Create</strong></p>
</li>
<li><dl class="first docutils">
<dt>Enter a new A record based on the picture below and click</dt>
<dd><p class="first last"><strong>Finished</strong>.</p>
</dd>
</dl>
</li>
</ul>
<p><a class="reference internal" href="_images/image13.png"><img alt="image10" src="_images/image13.png" style="width: 3.64000in; height: 2.46000in;" /></a></p>
<ul>
<li><dl class="first docutils">
<dt>Note the logs in each F5. You will see BIGIP2 perform a zone transfer</dt>
<dd><p class="first last">from ZR after receiving a NOTIFY. You will then see BIGIP1
receive a NOTIFY and obtain a zone transfer.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Note that we didn’t have to tell GTM where to send a NOTIFY. Those</dt>
<dd><p class="first last">messages are automatically sent to the Zone Transfer Clients
configured for the zone.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Issue the following command from SSH console on BIGIP1 to see the</dt>
<dd><p class="first last">status and statistics related to the zone. <em>Take note of the
“Notifies Received” counter.</em></p>
</dd>
</dl>
<p><strong>tmsh show ltm dns zone student2.com |more</strong></p>
</li>
<li><dl class="first docutils">
<dt>Issue the following command from SSH console on BIGIP2 to see the</dt>
<dd><p class="first last">status and statistics related to the zone. <em>Take note of the
“Notifies To Client” counter.</em></p>
</dd>
</dl>
<p><strong>tmsh show ltm dns zone student2.com |more</strong></p>
</li>
<li><dl class="first docutils">
<dt>Validate DNS Express was updated by performing a dnsxdump |more</dt>
<dd><p class="first last">and/or query for your new record to the Listener.</p>
</dd>
</dl>
</li>
</ul>
<p><strong>Close out your browser session to BIGIP2, we will no longer be using it.</strong></p>
</div>
</div>
<div class="section" id="exercise-2-1-transparent-caching">
<h2>5.6. EXERCISE 2.1 – TRANSPARENT CACHING<a class="headerlink" href="#exercise-2-1-transparent-caching" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>In this use-case, you will configure GTM as a transparent cache to a
pool of BIND servers.</li>
<li>Estimated completion time: 10 minutes</li>
</ul>
<p><a class="reference internal" href="_images/image14.png"><img alt="image11" src="_images/image14.png" style="width: 4.25347in; height: 3.55347in;" /></a></p>
<div class="section" id="task-1-create-a-dns-cache">
<h3>5.6.1. TASK 1 – Create a DNS Cache<a class="headerlink" href="#task-1-create-a-dns-cache" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Caches &gt; Cache List: Create</strong></li>
<li>Create a new DNS profile as shown in the table below. Keep the
defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">transparent-cache</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Resolver Type</strong></td>
<td>Transparent (none)</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Click <strong>Finished</strong> to create.</li>
</ul>
</div>
<div class="section" id="id3">
<h3>5.6.2. TASK 2 – Create a new DNS Profile<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Profiles &gt; DNS: Create</strong>.
Create a new DNS profile as shown in the table below. Keep the
defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">Transparent</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>DNSSEC</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-odd"><td><strong>GSLB</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-even"><td><strong>DNS Express</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-odd"><td><strong>DNS Cache</strong></td>
<td>Enabled</td>
</tr>
<tr class="row-even"><td><strong>DNS Cache Name</strong></td>
<td>transparent-cache</td>
</tr>
<tr class="row-odd"><td><strong>Use BIND Server on Big-IP</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-even"><td><strong>Logging</strong></td>
<td>Enabled</td>
</tr>
<tr class="row-odd"><td><strong>Logging Profile</strong></td>
<td>dns-logging //from previous lab</td>
</tr>
<tr class="row-even"><td><strong>AVR Statistics Sampling Rate</strong></td>
<td>Enabled; 1/1 queries sampled</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="task-3-create-a-dns-monitor">
<h3>5.6.3. TASK 3 – Create a DNS Monitor<a class="headerlink" href="#task-3-create-a-dns-monitor" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Load Balancing &gt;
Monitors: Create</strong>. Create a new DNS monitor as shown in the table
below. Keep the defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">mon_resolver</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Type</strong></td>
<td>DNS</td>
</tr>
<tr class="row-odd"><td><strong>Query Name</strong></td>
<td><a class="reference external" href="http://www.f5.com">www.f5.com</a></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Click <strong>Finished</strong> to create.</li>
</ul>
</div>
<div class="section" id="task-4-create-a-resolver-pool">
<h3>5.6.4. TASK 4 – Create a Resolver Pool<a class="headerlink" href="#task-4-create-a-resolver-pool" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Load Balancing &gt; Pools &gt;
Pools List: Create</strong>. Create a new pool of DNS resolvers as shown in
the figure below.</li>
<li>Add pool called <strong>pool_resolvers</strong> with health monitor
(<strong>mon_resolver</strong>) and members as shown in table and diagram below:</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Pool Members</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>10.128.20.101:53</td>
</tr>
<tr class="row-odd"><td>10.128.20.102:53</td>
</tr>
<tr class="row-even"><td>10.128.20.103:53</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="_images/image15.png"><img alt="image12" src="_images/image15.png" style="width: 4.24000in; height: 4.25000in;" /></a></p>
</div>
<div class="section" id="task-5-create-a-new-external-dns-listener">
<h3>5.6.5. TASK 5 – Create a new External DNS Listener<a class="headerlink" href="#task-5-create-a-new-external-dns-listener" title="Permalink to this headline">¶</a></h3>
<p>We are going to create a new external-facing DNS Listener to cache DNS
requests and load-balance non-cached requests to pool_resolvers.</p>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Listeners &gt; Listener
List: Create</strong></li>
<li>Create a Listener named ‘<strong>resolver-listener</strong>’ as shown in the
figure below. Use the Listener IP of <strong>10.128.10.54</strong>. <em>**Note that
you need to be in the “Advanced” Menu to set some of the options</em>.</li>
</ul>
<p><a class="reference internal" href="_images/image16.png"><img alt="image13" src="_images/image16.png" style="width: 4.71000in; height: 6.97000in;" /></a></p>
<ul class="simple">
<li>From your workstation at a command prompt, perform several recursive
queries to your new listener to test. You will want to repeat some of the same queries multiple times
We are attempting to see cache hits. Below are some
examples:</li>
<li>dig &#64;10.128.10.54 www.f5.com</li>
<li>dig &#64;10.128.10.54 www.wikipedia.org</li>
<li>dig &#64;10.128.10.54 <a class="reference external" href="http://www.ncsu.edu">www.ncsu.edu</a></li>
<li>You should have successful resolution. Now it’s time to see
statistics and cache entries.</li>
<li><strong>Viewing Cache Entries</strong></li>
<li><dl class="first docutils">
<dt>In the SSH shell, type tmsh show ltm dns cache records rrset cache</dt>
<dd>transparent-cache</dd>
</dl>
</li>
<li>Your output should look similar to below with several entries</li>
</ul>
<p><a class="reference internal" href="_images/image17.png"><img alt="image14" src="_images/image17.png" style="width: 5.46000in; height: 2.55000in;" /></a></p>
<ul class="simple">
<li>If you go to the TMSH console, you can see several other ways to
query the cache database. Below show some examples.</li>
<li>View cache entries for a particular domain / owner:</li>
</ul>
<p><a class="reference internal" href="_images/image18.png"><img alt="image15" src="_images/image18.png" style="width: 5.46000in; height: 1.54000in;" /></a></p>
<ul class="simple">
<li>View cache entries of a particular RR type:</li>
</ul>
<p><a class="reference internal" href="_images/image19.png"><img alt="image16" src="_images/image19.png" style="width: 5.46000in; height: 1.95000in;" /></a></p>
<ul class="simple">
<li><dl class="first docutils">
<dt>There are other options… feel free to play around and familiarize</dt>
<dd>yourself with the options.</dd>
</dl>
</li>
</ul>
<p><strong>- Viewing Cache Statistics</strong></p>
<ul class="simple">
<li>In the SSH shell, <strong>type tmsh show ltm dns cache transparent transparent-cache</strong></li>
<li><dl class="first docutils">
<dt>Your output should look similar to below with statistics showing Hits</dt>
<dd>and Misses in particular.</dd>
</dl>
</li>
</ul>
<p><a class="reference internal" href="_images/image20.png"><img alt="image17" src="_images/image20.png" style="width: 5.45000in; height: 3.26000in;" /></a></p>
<ul class="simple">
<li><dl class="first docutils">
<dt>In the GUI, you can find similar data as above by navigating</dt>
<dd><strong>Statistics &gt; Module Statistics &gt; DNS &gt; Caches</strong>.</dd>
</dl>
</li>
<li>Select “Statistics Type” of Caches.</li>
<li>Select “View” under the Details column for transparent-cache</li>
<li>Note that stats can also be reset from this view (Reset).</li>
</ul>
<p><a class="reference internal" href="_images/image21.png"><img alt="image18" src="_images/image21.png" style="width: 3.86667in; height: 2.92014in;" /></a></p>
<ul class="simple">
<li><dl class="first docutils">
<dt>Spend some time looking in the DNS Analytics to verify that AVR is</dt>
<dd>graphing query stats as expected.</dd>
</dl>
</li>
</ul>
<p><strong>- Deleting Cache Entries</strong></p>
<ul>
<li><dl class="first docutils">
<dt>Specific cache entries can be deleted via the TMSH console. Entries</dt>
<dd><p class="first last">to be deleted can be filtered by several aspects.</p>
</dd>
</dl>
</li>
<li><p class="first">In the TMSH shell, go to the DNS prompt and type</p>
<p>delete cache records rrset cache transparent-cache ?</p>
</li>
<li><dl class="first docutils">
<dt>Now delete individual records by type and owner. Below show some</dt>
<dd><p class="first last">examples.</p>
</dd>
</dl>
</li>
</ul>
<p><a class="reference internal" href="_images/image22.png"><img alt="image19" src="_images/image22.png" style="width: 5.87000in; height: 3.78000in;" /></a></p>
<p><strong>- Clearing Entire Cache</strong></p>
<ul class="simple">
<li>Via the GUI, navigate to <strong>Statistics &gt; Module Statistics &gt; DNS &gt; Caches</strong></li>
<li>Set “Statistics Type” to “Caches”.</li>
<li>You can select the cache and click “Clear Cache” to empty the cache.</li>
</ul>
</div>
</div>
<div class="section" id="exercise-2-2-resolver-cache">
<h2>5.7. EXERCISE 2.2 – RESOLVER CACHE<a class="headerlink" href="#exercise-2-2-resolver-cache" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><dl class="first docutils">
<dt>In this use case, you will configure GTM as a resolver cache which</dt>
<dd>eliminates the need for the pool of resolvers.</dd>
</dl>
</li>
<li>Estimated completion time: 10 minutes</li>
</ul>
<p><a class="reference internal" href="_images/image23.png"><img alt="image20" src="_images/image23.png" style="width: 4.58264in; height: 2.95764in;" /></a></p>
<div class="section" id="task-1-create-a-new-dns-cache">
<h3>5.7.1. TASK 1 – Create a new DNS Cache<a class="headerlink" href="#task-1-create-a-new-dns-cache" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Caches &gt; Cache List: Create</strong></li>
<li>Create a new DNS Cache as shown in the table below. Keep the defaults
if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="54%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">resolver-cache</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Resolver Type</strong></td>
<td>Resolver</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id4">
<h3>5.7.2. TASK 2 – Create a new DNS Profile<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Profiles &gt; DNS: Create</strong>.
Create a new DNS profile as shown in the table below. Keep the
defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">Resolver</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>DNSSEC</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-odd"><td><strong>GSLB</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-even"><td><strong>DNS Express</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-odd"><td><strong>DNS Cache</strong></td>
<td>Enabled</td>
</tr>
<tr class="row-even"><td><strong>DNS Cache Name</strong></td>
<td>resolver-cache</td>
</tr>
<tr class="row-odd"><td><strong>Unhandled Query Action</strong></td>
<td>Drop</td>
</tr>
<tr class="row-even"><td><strong>Use BIND Server on Big-IP</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-odd"><td><strong>Logging</strong></td>
<td>Enabled</td>
</tr>
<tr class="row-even"><td><strong>Logging Profile</strong></td>
<td>dns-logging //from previous lab</td>
</tr>
<tr class="row-odd"><td><strong>AVR Statistics Sampling Rate</strong></td>
<td>Enabled; 1/1 queries sampled</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="task-3-edit-dns-listener">
<h3>5.7.3. TASK 3 – Edit DNS Listener<a class="headerlink" href="#task-3-edit-dns-listener" title="Permalink to this headline">¶</a></h3>
<p>We will now apply the new profile to the existing DNS Listener.</p>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Listeners &gt; Listener List</strong></li>
<li>Select ‘resolver-listener’ and modify the following settings.</li>
<li><dl class="first docutils">
<dt>Change the DNS profile to ‘resolver’ and uncheck “Address</dt>
<dd>Translation” (under Listener Advanced options). Click <strong>Update</strong>.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Select “Load Balancing” from the middle menu above, and Select the</dt>
<dd>Default Pool as “None” and click <strong>Update</strong>.</dd>
</dl>
</li>
<li>Your Listener should now be setup as a caching resolver.</li>
<li>From your workstation command prompt, perform several recursive
queries to your external Listener to test. You will want to repeat
some of the same queries multiple times. We are attempting to see
cache hits and perform recursive queries. Below are some examples:</li>
<li>dig &#64;10.128.10.54 www.cnn.com</li>
<li>dig &#64;10.128.10.54 www.google.com</li>
<li>dig &#64;10.128.10.54 www.umich.edu</li>
</ul>
<p><strong>- Viewing Cache Statistics</strong></p>
<ul>
<li><p class="first">In the SSH shell, type <strong>tmsh show ltm dns cache resolver resolver-cache |more</strong></p>
<p>Your output should look similar to below with statistics. Bits
In/Out, Packets In/Out and Connections are of particular interest.</p>
</li>
</ul>
<p><a class="reference internal" href="_images/image24.png"><img alt="image21" src="_images/image24.png" style="width: 5.76000in; height: 3.47000in;" /></a></p>
</div>
</div>
<div class="section" id="exercise-2-3-validating-resolver">
<h2>5.8. EXERCISE 2.3 – VALIDATING RESOLVER<a class="headerlink" href="#exercise-2-3-validating-resolver" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>In this use case, you will configure GTM as a DNSSEC validating
resolver which offloads heavy CPU computation to traditional
resolvers. This simply adds DNSSEC validation to the resolver-cache
use-case previously configured.</li>
<li>Estimated completion time: 10 minutes</li>
</ul>
<div class="section" id="id5">
<h3>5.8.1. TASK 1 – Create a new DNS Cache<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Caches &gt; Cache List: Create</strong></li>
<li>Create a new DNS cache as shown in the table below. Keep the defaults
if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">validating-resolver</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>Resolver Type</strong></td>
<td>Validating Resolver</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">A Trust Anchor must be configured so that the validating resolver has
a starting
point for validation. This can be done manually via the SSH console.
You can obtain the root server DS keys by using dig and its related
utilities as follows:</p>
</li>
<li><p class="first">In the interest of time, the trust anchors are located on your
desktop as a text file named TrustAnchors.txt. You can simply cut
and paste the values into the GUI. If you want to run the
utilities to obtain the anchors, the commands are below for your
reference.</p>
</li>
<li><dl class="first docutils">
<dt>Get the root name servers in DNSKEY format and output to the file</dt>
<dd><p class="first last">&#8220;root-dnskey&#8221;</p>
</dd>
</dl>
<p>&gt;dig +multi +noall +answer DNSKEY . &gt;root-dnskey</p>
</li>
<li><p class="first">Convert the root trust anchors from DNSKEY format to DS</p>
<p>&gt;dnssec-dsfromkey -f root-dnskey . &gt;root-ds</p>
</li>
<li><p class="first">Output of the root DS keys</p>
<p>&gt;cat ./root-ds</p>
<p>IN DS 19036 8 1 B256BD09DC8DD59F0E0F0D8541B8328DD986DF6E</p>
<p>IN DS 19036 8 2
49AAC11D7B6F6446702E54A1607371607A1A41855200FD2CE1CDDE32 F24E8FB5</p>
</li>
<li><dl class="first docutils">
<dt>Each of the 2 lines in the TrustAnchor.txt file should be entered as</dt>
<dd><p class="first last">a new trust anchor (2 total).</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>In the GUI, navigate to: <strong>DNS &gt; Caches &gt; Cache List</strong>. Select</dt>
<dd><p class="first last">“validating-resolver” and click on <strong>Trust Anchors</strong> on the top
menu. Click <strong>Add</strong>. Copy each line from the TrustAnchor.txt file
as a Trust Anchor entry. You should end with a total of two
entries.</p>
</dd>
</dl>
</li>
<li><p class="first">The figure below shows what your configuration should look like.</p>
</li>
</ul>
<p><a class="reference internal" href="_images/image25.png"><img alt="image22" src="_images/image25.png" style="width: 4.00694in; height: 1.06042in;" /></a></p>
</div>
<div class="section" id="id6">
<h3>5.8.2. TASK 2 – Create a new DNS Profile<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Profiles &gt; DNS: Create</strong>.
Create a new DNS profile as shown in the table below. Keep the
defaults if not noted in the table.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Name</strong></th>
<th class="head">Validating</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>DNSSEC</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-odd"><td><strong>GSLB</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-even"><td><strong>DNS Express</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-odd"><td><strong>DNS Cache</strong></td>
<td>Enabled</td>
</tr>
<tr class="row-even"><td><strong>DNS Cache Name</strong></td>
<td>validating-resolver</td>
</tr>
<tr class="row-odd"><td><strong>Unhandled Query Action</strong></td>
<td>Drop</td>
</tr>
<tr class="row-even"><td><strong>Use BIND Server on Big-IP</strong></td>
<td>Disabled</td>
</tr>
<tr class="row-odd"><td><strong>Logging</strong></td>
<td>Enabled</td>
</tr>
<tr class="row-even"><td><strong>Logging Profile</strong></td>
<td>dns-logging //from previous lab</td>
</tr>
<tr class="row-odd"><td><strong>AVR Statistics Sampling Rate</strong></td>
<td>Enabled; 1/1 queries sampled</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id7">
<h3>5.8.3. TASK 3 – Edit DNS Listener<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>We will now apply the new profile to the existing DNS Listener.</p>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Delivery &gt; Listeners &gt; Listener List</strong></li>
<li>Select ‘<strong>resolver-listener</strong>’ and modify the DNS Profile to use
“<strong>validating</strong>”.</li>
<li>Your Listener should now be setup as a validating resolver.</li>
<li><strong>Use-Case: Valid Signed Zone.</strong> From your workstation, perform
several recursive
queries to your external Listener to test. Perform the following command
2 or 3 times:</li>
<li>dig &#64;10.128.10.54 internetsociety.org</li>
<li><dl class="first docutils">
<dt>In the SSH shell, type tmsh show ltm dns cache validating-resolver</dt>
<dd>|more</dd>
</dl>
</li>
</ul>
<p>Your output should look similar to below with statistics. Response
Validation</p>
<p>and DNSSEC Key stats are of particular interest in this use-case.</p>
<p><a class="reference internal" href="_images/image26.png"><img alt="image23" src="_images/image26.png" style="width: 5.76000in; height: 3.47000in;" /></a></p>
<ul>
<li><dl class="first docutils">
<dt>In the GUI, you can find similar data as above by navigating</dt>
<dd><p class="first last"><strong>Statistics &gt; Module Statistics &gt; DNS &gt; Caches</strong>.</p>
</dd>
</dl>
</li>
<li><p class="first">Select “Statistics Type” of Caches.</p>
</li>
<li><p class="first">Select “View” under the Details column for validating-resolver</p>
</li>
<li><dl class="first docutils">
<dt>Note the size of the cache for just this single RR query. You can</dt>
<dd><blockquote class="first">
<div><p>view what’s in the cache from the CLI with:</p>
</div></blockquote>
<p class="last">tmsh show ltm dns cache records rrset cache validating-resolver
|more</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>Use-Case: Invalid Signed Zone:</strong> From your workstation, perform
several recursive queries to your external Listener to test. Perform the
following command 2 or 3 times:</p>
</li>
<li><p class="first">dig &#64;10.128.10.54 dnssec-failed.org</p>
</li>
<li><dl class="first docutils">
<dt>Run the same steps above to view statistics and see the difference</dt>
<dd><p class="first last">what happens when trust is broken. What statistic incremented?
What was the query response to the client?</p>
</dd>
</dl>
</li>
</ul>
</div>
</div>
<div class="section" id="exercise-2-4-forwarders">
<h2>5.9. EXERCISE 2.4 – FORWARDERS<a class="headerlink" href="#exercise-2-4-forwarders" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>In this use-case, we will configure conditional forwarders with local
zone information.</li>
<li>Estimated completion time: 5 minutes</li>
</ul>
<div class="section" id="task-1-add-forwarder-to-existing-cache">
<h3>5.9.1. TASK 1 – Add Forwarder to Existing Cache<a class="headerlink" href="#task-1-add-forwarder-to-existing-cache" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>In the GUI, navigate to: <strong>DNS &gt; Caches &gt; Cache List</strong>. Click on
<strong>validating-resolver</strong> from the previous exercise. Click <strong>Forward Zones</strong>
from the top menu.</li>
<li>Click <strong>Add</strong> and configure as shown in the figure below and then
click <strong>Finished</strong>:</li>
</ul>
<p><a class="reference internal" href="_images/image27.png"><img alt="image24" src="_images/image27.png" style="width: 4.31000in; height: 2.82000in;" /></a></p>
<ul>
<li><p class="first">From your workstation, perform the following recursive queries to your
external Listener to test.</p>
</li>
<li><p class="first">dig &#64;10.128.10.54 www.forward.com</p>
</li>
<li><p class="first">dig &#64;10.128.10.54 mail.forward.com</p>
</li>
<li><p class="first">In the SSH shell, type tmsh show ltm dns cache validating-resolver |
more</p>
<blockquote>
<div><p>Your output should look similar to below with statistics. Forwarder
Activity stats are of particular interest in this use-case.</p>
</div></blockquote>
</li>
</ul>
<p><a class="reference internal" href="_images/image28.png"><img alt="image25" src="_images/image28.png" style="width: 5.76000in; height: 3.47000in;" /></a></p>
<ul class="simple">
<li><dl class="first docutils">
<dt>In the GUI, you can find similar data as above by navigating</dt>
<dd><strong>Statistics &gt; Module Statistics &gt; DNS &gt; Caches</strong>.</dd>
</dl>
</li>
<li>Select “Statistics Type” of Caches.</li>
<li>Select “View” under the Details column for validating-resolver</li>
</ul>
</div>
</div>
<div class="section" id="learn-more">
<h2>5.10. Learn More<a class="headerlink" href="#learn-more" title="Permalink to this headline">¶</a></h2>
<p>Notes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">F5 Networks, Inc. | f5.com</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>US Headquarters: 401 Elliott Ave W, Seattle, WA 98119 | 888-882-4447 // Americas: <a class="reference external" href="mailto:info&#37;&#52;&#48;f5&#46;com">info<span>&#64;</span>f5<span>&#46;</span>com</a> // Asia-Pacific: <a class="reference external" href="mailto:apacinfo&#37;&#52;&#48;f5&#46;com">apacinfo<span>&#64;</span>f5<span>&#46;</span>com</a> // Europe/Middle East/Africa: <a class="reference external" href="mailto:emeainfo&#37;&#52;&#48;f5&#46;com">emeainfo<span>&#64;</span>f5<span>&#46;</span>com</a> // Japan: <a class="reference external" href="mailto:f5j-info&#37;&#52;&#48;f5&#46;com">f5j-info<span>&#64;</span>f5<span>&#46;</span>com</a>
©2017 F5 Networks, Inc. All rights reserved. F5, F5 Networks, and the F5 logo are trademarks of F5 Networks, Inc. in the U.S. and in certain other countries. Other F5 trademarks are identified at f5.com. Any other products, services, or company names referenced herein may be trademarks of their respective owners with no endorsement or affiliation, express or implied, claimed by F5. These training materials and documentation are F5&nbsp;Confidential Information and are subject to the F5 Networks Reseller Agreement. You may not share these training materials and documentation with any third party without the express written permission of F5.</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rpz/index.html" class="btn btn-neutral float-right" title="6. RPZ" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cache/index.html" class="btn btn-neutral" title="4. Cache" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Agility DNS team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>